# 索引

## B+树

B+树是一种按页划分，按序存放的N叉树，用于存放`索引`。如下图所示：

![](https://static001.geekbang.org/resource/image/dc/8d/dcda101051f28502bd5c4402b292e38d.png)


其中主键索引的叶子节点的值为`行记录`

非主键索引的叶子节点的值为其表的`主键值`

主键索引建议考虑使用自增方式，减少索引插入、移动、分页的操作。非主键索引无可避免。

联合索引的顺序是按照所以字段依次排序

---

## 覆盖索引

`按照身份证查询姓名` 如果是一个高频操作，如何组织索引？

当有联合索引，联合索引中包括查询结果字段，就不需要进行回表，提升效率。


## 最左前缀原则
索引是按照索引字段的顺序进行存储的，可以按照最左测的前缀进行快速搜索。

![](https://static001.geekbang.org/resource/image/89/70/89f74c631110cfbc83298ef27dcd6370.jpg)

```
例如：

按照最左前缀原则：当设置联合索引(a,b)时，就不需要再定义(a) 索引了。但是(b)的单独索引还是有必要的。
```
1. 首先考虑索引复用问题，尽量通过规划`索引顺序`，少建立索引

2. 当存在单独索引时，应该考虑存储空间。

```
例如：

存在name、age的联合查询，以及name、age的独立查询，应该考虑
1. 建立(name，age)联合索引, 用于支持 联合查询 及 name 的独立查询
2. 建立(age)索引,用于 age 的独立查询
```



## 索引下推

MYSQL5.6以后，支持索引下推，即在索引部分进行条件判断后进行回表。

*5.6之前，会依赖最左前缀法则找到第一个符合条件的记录，然后直接进行回表，在行记录中做条件判断，回表次数较多。*


